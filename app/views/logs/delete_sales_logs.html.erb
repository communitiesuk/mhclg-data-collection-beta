<% title = "Delete logs" %>
<% content_for :title, title %>
<% content_for :before_content do %>
  <%= govuk_back_link(href: :back) %>
<% end %>

<h1 class="govuk-heading-l">
  <span class="govuk-caption-l"><%= title %></span>
  Review the logs you want to delete
</h1>
<p>You've selected <%= @delete_logs_form.log_count %> <%= "log".pluralize(@delete_logs_form.log_count) %> to delete</p>

<%= form_with model: @delete_logs_form, url: @delete_logs_form.delete_confirmation_path do |f| %>
  <%= f.hidden_field :search_term, value: @delete_logs_form.search_term %>
  <%= f.govuk_error_summary %>
  <%= govuk_table do |table| %>
    <% table.head do |head| %>
      <% head.row do |row| %>
        <% row.cell(header: true, text: "Log ID") %>
        <% row.cell(header: true, text: "Owning Organisation") %>
        <% row.cell(header: true, text: "Created") %>
        <% row.cell(header: true, text: "Status") %>
        <% row.cell(header: true, text: "Delete?") %>
      <% end %>
    <% end %>
    <% table.body do |body| %>
      <% f.govuk_check_boxes_fieldset :selected_ids, small: true do %>
        <% @delete_logs_form.logs.each do |log| %>
          <% body.row do |row| %>
            <% row.cell(text: log.id) %>
            <% row.cell(text: log.owning_organisation&.name) %>
            <% row.cell(text: log.created_at&.to_formatted_s(:govuk_date)) %>
            <% row.cell(text: status_tag(log.status)) %>
            <% row.cell do %>
              <% f.govuk_check_box :selected_ids, log.id,
                label: { text: log.id, hidden: true },
                size: "s",
                checked: @delete_logs_form.selected_ids.include?(log.id) %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
  <%= f.govuk_submit "Continue" do %>
    <%= govuk_button_link_to "Cancel", @delete_logs_form.back_to_logs_path, secondary: true %>
  <% end %>
<% end %>
