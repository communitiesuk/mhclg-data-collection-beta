<% title = "#{action.humanize} #{@location.name}" %>
<% content_for :title, title %>

<% content_for :before_content do %>
  <%= govuk_back_link(
    text: "Back",
    href: scheme_location_path(@location.scheme, @location),
  ) %>
<% end %>
<% form_path = action == "deactivate" ? scheme_location_new_deactivation_path(scheme_id: @location.scheme.id, location_id: @location.id) : scheme_location_new_reactivation_path(scheme_id: @location.scheme.id, location_id: @location.id) %>

<%= form_with model: @location, url: form_path, method: "patch", local: true do |f| %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
    <% collection_start_date = FormHandler.instance.current_collection_start_date %>
    <% date_question = action == "deactivate" ? :deactivation_date : :reactivation_date %>
    <% date_type_question = action == "deactivate" ? :deactivation_date_type : :reactivation_date_type %>
    <%= f.govuk_error_summary %>
        <%= f.govuk_radio_buttons_fieldset date_type_question,
                                            legend: { text: I18n.t("questions.location.deactivate.apply_from") },
                                            caption: { text: title },
                                            hint: { text: I18n.t("hints.location.deactivate", date: collection_start_date.to_formatted_s(:govuk_date)) } do %>
            <%= govuk_warning_text text: I18n.t("warnings.location.#{action}.existing_logs") %>
            <%= f.govuk_radio_button date_type_question,
                                        "default",
                                        label: { text: "From the start of the current collection period (#{collection_start_date.to_formatted_s(:govuk_date)})" } %>

            <%= f.govuk_radio_button date_type_question,
                                        "other",
                                        label: { text: "For tenancies starting after a certain date" },
                                        **basic_conditional_html_attributes({ "deactivation_date" => %w[other] }, "location") do %>
                                          <%= f.govuk_date_field date_question,
                                                        legend: { text: "Date", size: "m" },
                                                        hint: { text: "For example, 27 3 2022" },
                                                        width: 20 %>
                                                        <% end %>
        <% end %>

        <%= f.govuk_submit "Continue" %>
    </div>
  </div>
<% end %>
