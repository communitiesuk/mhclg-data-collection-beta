<% if @searched.present? %>
  <% item_label = @pagy.count > 1 ? "users" : "user" %>
  <% total_user_count = User.all.count %>
  <% title = "Your organisation (#{@pagy.count} #{item_label} matching ‘#{@searched}’ of #{total_user_count} total users)" %>
<% else %>
  <% item_label = "" %>
  <% total_user_count = nil %>
  <% title = "Your organisation (Users)" %>
<% end %>

<% content_for :title, title %>

<% content_for :tab_title do %>
  <%= "Users" %>
<% end %>

<% if current_user.data_coordinator? || current_user.support? %>
  <%= govuk_button_link_to "Invite user", new_user_path, html: { method: :get } %>
<% end %>

<%= render SearchComponent.new(current_user:, search_label: "Search by name or email address", value: @searched) %>

<hr class="govuk-section-break govuk-section-break--visible govuk-section-break--m">

<%= render partial: "users/user_list", locals: { users: @users, title:, pagy: @pagy, searched: @searched, item_label:, total_user_count: } %>
<%== render partial: "pagy/nav", locals: { pagy: @pagy, item_name: "users" } %>
